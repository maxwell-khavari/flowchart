<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Image Generation Automation Technical Flowchart</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.21.1/cytoscape.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            text-align: center;
            padding: 25px;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 28px;
            font-weight: bold;
        }
        
        .header p {
            margin: 0;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .flowchart-wrapper {
            position: relative;
            width: 100%;
            height: 2500px;
            background: white;
            overflow: auto;
        }
        
        #flowchart {
            width: 100%;
            height: 2500px;
            min-width: 900px;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-size: 12px;
            z-index: 1000;
        }
        
        .legend h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            margin-right: 8px;
            border: 1px solid #ccc;
        }

        .stats {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-size: 12px;
            z-index: 1000;
        }

        .stats h4 {
            margin: 0 0 10px 0;
            color: #333;
        }

        .stat-line {
            margin-bottom: 5px;
            color: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ¤– AI IMAGE GENERATION AUTOMATION PIPELINE</h1>
            <p>Automated Stanford AI Playground workflow generating 1,000+ enhanced images</p>
        </div>
        
        <div class="flowchart-wrapper">
            <div id="flowchart"></div>
            
            <div class="stats">
                <h4>Pipeline Stats</h4>
                <div class="stat-line"><strong>1,000</strong> Total Images</div>
                <div class="stat-line"><strong>6</strong> Prompt Cards</div>
                <div class="stat-line"><strong>5</strong> AI Models</div>
                <div class="stat-line"><strong>30</strong> Combinations</div>
                <div class="stat-line"><strong>55s</strong> Per Image</div>
                <div class="stat-line"><strong>3</strong> Files Per Image</div>
            </div>
            
            <div class="legend">
                <h4>Node Types</h4>
                <div class="legend-item">
                    <div class="legend-color" style="background: #e74c3c;"></div>
                    <span>Start/End</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #3498db;"></div>
                    <span>Process</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f39c12;"></div>
                    <span>Data</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #9b59b6;"></div>
                    <span>AI Model</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #27ae60;"></div>
                    <span>Output</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #95a5a6;"></div>
                    <span>Decision</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const cy = cytoscape({
            container: document.getElementById('flowchart'),
            
            elements: [
                // Start
                { data: { id: 'start', label: 'START\nPipeline', type: 'start' } },
                
                // Initialization Phase
                { data: { id: 'launch-browser', label: 'Launch\nPlaywright\nChromium', type: 'process' } },
                { data: { id: 'auth', label: 'Stanford AI\nPlayground\nAuth', type: 'process' } },
                { data: { id: 'create-dir', label: 'Create Output\nDirectory\n~/Desktop/AI_IMG_GPT', type: 'process' } },
                
                // Planning Phase
                { data: { id: 'load-cards', label: 'Load 6\nPrompt Cards\n(PROMPTS object)', type: 'data' } },
                { data: { id: 'load-models', label: 'Load 5 AI Models\no1, o3-mini, gpt-4.1\ngpt-4o, gpt-4o-mini', type: 'data' } },
                { data: { id: 'create-plan', label: 'Generate\nDistribution Plan\n1000 images / 30 combos', type: 'process' } },
                
                // Main Loop Start
                { data: { id: 'loop-start', label: 'FOR EACH\nImage (1-1000)', type: 'decision' } },
                { data: { id: 'select-combo', label: 'Select Card +\nModel Combination', type: 'process' } },
                
                // Step 1: Prompt Extraction
                { data: { id: 'extract-prompt', label: 'Extract Original\nPrompt from\nPROMPTS[key]', type: 'process' } },
                { data: { id: 'original-prompt', label: 'Original Prompt\nText', type: 'data' } },
                
                // Step 2: GPT Enhancement
                { data: { id: 'new-chat-gpt', label: 'Open New Chat\naiplayground-prod2\n.stanford.edu/c/new', type: 'process' } },
                { data: { id: 'select-model', label: 'Select AI Model\n(o1/o3-mini/gpt-4.1\n/gpt-4o/gpt-4o-mini)', type: 'ai-model' } },
                { data: { id: 'enhancement-request', label: 'Send Enhancement\nRequest:\n"Please enhance this\nimage prompt..."', type: 'process' } },
                { data: { id: 'wait-gpt', label: 'Wait 30s for\nGPT Response', type: 'process' } },
                { data: { id: 'copy-response', label: 'Copy GPT Response\nusing clipboard\nbutton (last button)', type: 'process' } },
                { data: { id: 'clean-prompt', label: 'Clean Enhanced\nPrompt\n(remove meta-text)', type: 'process' } },
                { data: { id: 'enhanced-prompt', label: 'Enhanced Prompt\n(detailed & vivid)', type: 'data' } },
                
                // Step 3: DALL-E Generation
                { data: { id: 'new-chat-dalle', label: 'Open New Chat\nfor DALL-E', type: 'process' } },
                { data: { id: 'select-dalle', label: 'Select DALL-E\nModel (Agents\n> Dalle-)', type: 'ai-model' } },
                { data: { id: 'send-to-dalle', label: 'Send Enhanced\nPrompt to DALL-E', type: 'process' } },
                { data: { id: 'wait-dalle', label: 'Wait 25s for\nImage Generation', type: 'process' } },
                { data: { id: 'image-generated', label: 'Generated Image\n(DALL-E output)', type: 'data' } },
                
                // Step 4: Data Processing
                { data: { id: 'extract-demographics', label: 'Extract Gender &\nRace from Prompt\n(40 keywords)', type: 'process' } },
                { data: { id: 'demographic-data', label: 'Demographic\nMetadata\n{gender, race}', type: 'data' } },
                
                // Step 5: File Output
                { data: { id: 'take-screenshot', label: 'Take Page\nScreenshot\n(.png)', type: 'process' } },
                { data: { id: 'save-prompt', label: 'Save Enhanced\nPrompt (.txt)', type: 'process' } },
                { data: { id: 'save-metadata', label: 'Save Complete\nMetadata (.json)', type: 'process' } },
                
                // Output Files
                { data: { id: 'png-file', label: 'Screenshot\n.PNG File', type: 'output' } },
                { data: { id: 'txt-file', label: 'Prompt\n.TXT File', type: 'output' } },
                { data: { id: 'json-file', label: 'Metadata\n.JSON File\n(full workflow data)', type: 'output' } },
                
                // Loop Control
                { data: { id: 'progress-log', label: 'Log Progress\n(X/1000 complete)', type: 'process' } },
                { data: { id: 'loop-check', label: 'All 1000\nImages Done?', type: 'decision' } },
                { data: { id: 'error-handling', label: 'Error Handling\n(continue on fail)', type: 'process' } },
                
                // End
                { data: { id: 'cleanup', label: 'Close Browser\n& Cleanup', type: 'process' } },
                { data: { id: 'end', label: 'END\nPipeline Complete', type: 'start' } },

                // Edges (connections)
                { data: { source: 'start', target: 'launch-browser' } },
                { data: { source: 'launch-browser', target: 'auth' } },
                { data: { source: 'auth', target: 'create-dir' } },
                { data: { source: 'create-dir', target: 'load-cards' } },
                { data: { source: 'create-dir', target: 'load-models' } },
                { data: { source: 'load-cards', target: 'create-plan' } },
                { data: { source: 'load-models', target: 'create-plan' } },
                { data: { source: 'create-plan', target: 'loop-start' } },
                
                // Main processing flow
                { data: { source: 'loop-start', target: 'select-combo' } },
                { data: { source: 'select-combo', target: 'extract-prompt' } },
                { data: { source: 'extract-prompt', target: 'original-prompt' } },
                { data: { source: 'original-prompt', target: 'new-chat-gpt' } },
                { data: { source: 'new-chat-gpt', target: 'select-model' } },
                { data: { source: 'select-model', target: 'enhancement-request' } },
                { data: { source: 'enhancement-request', target: 'wait-gpt' } },
                { data: { source: 'wait-gpt', target: 'copy-response' } },
                { data: { source: 'copy-response', target: 'clean-prompt' } },
                { data: { source: 'clean-prompt', target: 'enhanced-prompt' } },
                { data: { source: 'enhanced-prompt', target: 'new-chat-dalle' } },
                { data: { source: 'new-chat-dalle', target: 'select-dalle' } },
                { data: { source: 'select-dalle', target: 'send-to-dalle' } },
                { data: { source: 'send-to-dalle', target: 'wait-dalle' } },
                { data: { source: 'wait-dalle', target: 'image-generated' } },
                { data: { source: 'image-generated', target: 'extract-demographics' } },
                { data: { source: 'enhanced-prompt', target: 'extract-demographics' } },
                { data: { source: 'extract-demographics', target: 'demographic-data' } },
                { data: { source: 'demographic-data', target: 'take-screenshot' } },
                { data: { source: 'image-generated', target: 'take-screenshot' } },
                { data: { source: 'take-screenshot', target: 'save-prompt' } },
                { data: { source: 'save-prompt', target: 'save-metadata' } },
                { data: { source: 'take-screenshot', target: 'png-file' } },
                { data: { source: 'save-prompt', target: 'txt-file' } },
                { data: { source: 'save-metadata', target: 'json-file' } },
                { data: { source: 'save-metadata', target: 'progress-log' } },
                { data: { source: 'progress-log', target: 'loop-check' } },
                
                // Loop back or continue
                { data: { source: 'loop-check', target: 'select-combo', label: 'No' } },
                { data: { source: 'loop-check', target: 'cleanup', label: 'Yes' } },
                { data: { source: 'cleanup', target: 'end' } },
                
                // Error handling
                { data: { source: 'copy-response', target: 'error-handling', type: 'error' } },
                { data: { source: 'wait-dalle', target: 'error-handling', type: 'error' } },
                { data: { source: 'error-handling', target: 'progress-log' } }
            ],

            style: [
                {
                    selector: 'node',
                    style: {
                        'width': 140,
                        'height': 70,
                        'label': 'data(label)',
                        'text-valign': 'center',
                        'text-halign': 'center',
                        'font-size': '11px',
                        'font-weight': 'bold',
                        'color': 'white',
                        'text-wrap': 'wrap',
                        'text-max-width': '130px',
                        'border-width': 3,
                        'border-color': '#2c3e50',
                        'shape': 'round-rectangle',
                        'text-outline-width': 1,
                        'text-outline-color': 'rgba(0,0,0,0.5)'
                    }
                },
                {
                    selector: 'node[type="start"]',
                    style: {
                        'background-color': '#e74c3c',
                        'shape': 'ellipse',
                        'width': 120,
                        'height': 60,
                        'font-size': '12px'
                    }
                },
                {
                    selector: 'node[type="process"]',
                    style: {
                        'background-color': '#3498db',
                        'shape': 'round-rectangle'
                    }
                },
                {
                    selector: 'node[type="data"]',
                    style: {
                        'background-color': '#f39c12',
                        'shape': 'rectangle'
                    }
                },
                {
                    selector: 'node[type="ai-model"]',
                    style: {
                        'background-color': '#9b59b6',
                        'shape': 'hexagon',
                        'width': 130,
                        'height': 90
                    }
                },
                {
                    selector: 'node[type="output"]',
                    style: {
                        'background-color': '#27ae60',
                        'shape': 'round-rectangle'
                    }
                },
                {
                    selector: 'node[type="decision"]',
                    style: {
                        'background-color': '#95a5a6',
                        'shape': 'diamond',
                        'width': 120,
                        'height': 80,
                        'color': '#2c3e50'
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'width': 4,
                        'line-color': '#2c3e50',
                        'target-arrow-color': '#2c3e50',
                        'target-arrow-shape': 'triangle',
                        'curve-style': 'bezier',
                        'arrow-scale': 2,
                        'opacity': 0.8
                    }
                },
                {
                    selector: 'edge[type="error"]',
                    style: {
                        'line-color': '#e74c3c',
                        'target-arrow-color': '#e74c3c',
                        'line-style': 'dashed',
                        'width': 2
                    }
                },
                {
                    selector: 'edge[label]',
                    style: {
                        'label': 'data(label)',
                        'font-size': '9px',
                        'color': '#2c3e50',
                        'text-background-color': 'white',
                        'text-background-opacity': 0.8,
                        'text-background-padding': '2px'
                    }
                }
            ],

            layout: {
                name: 'preset',
                positions: {
                    // Start and initialization - Spacing out more
                    'start': { x: 400, y: 80 },
                    'launch-browser': { x: 400, y: 180 },
                    'auth': { x: 400, y: 280 },
                    'create-dir': { x: 400, y: 380 },
                    
                    // Planning phase - Better spacing
                    'load-cards': { x: 250, y: 480 },
                    'load-models': { x: 550, y: 480 },
                    'create-plan': { x: 400, y: 580 },
                    
                    // Main loop
                    'loop-start': { x: 400, y: 680 },
                    'select-combo': { x: 400, y: 780 },
                    
                    // Step 1: Prompt extraction - More space
                    'extract-prompt': { x: 400, y: 880 },
                    'original-prompt': { x: 650, y: 880 },
                    
                    // Step 2: GPT Enhancement - Better vertical spacing
                    'new-chat-gpt': { x: 400, y: 980 },
                    'select-model': { x: 400, y: 1080 },
                    'enhancement-request': { x: 400, y: 1180 },
                    'wait-gpt': { x: 400, y: 1280 },
                    'copy-response': { x: 400, y: 1380 },
                    'clean-prompt': { x: 400, y: 1480 },
                    'enhanced-prompt': { x: 650, y: 1480 },
                    
                    // Step 3: DALL-E - More spacing
                    'new-chat-dalle': { x: 400, y: 1580 },
                    'select-dalle': { x: 400, y: 1680 },
                    'send-to-dalle': { x: 400, y: 1780 },
                    'wait-dalle': { x: 400, y: 1880 },
                    'image-generated': { x: 650, y: 1880 },
                    
                    // Step 4: Processing
                    'extract-demographics': { x: 400, y: 1980 },
                    'demographic-data': { x: 650, y: 1980 },
                    
                    // Step 5: File output - Spread horizontally
                    'take-screenshot': { x: 250, y: 2080 },
                    'save-prompt': { x: 400, y: 2080 },
                    'save-metadata': { x: 550, y: 2080 },
                    
                    // Output files - Spread more
                    'png-file': { x: 150, y: 2180 },
                    'txt-file': { x: 350, y: 2180 },
                    'json-file': { x: 550, y: 2180 },
                    
                    // Loop control
                    'progress-log': { x: 400, y: 2280 },
                    'loop-check': { x: 400, y: 2380 },
                    'error-handling': { x: 700, y: 1600 },
                    
                    // End
                    'cleanup': { x: 400, y: 2480 },
                    'end': { x: 400, y: 2580 }
                },
                fit: false,
                padding: 50
            }
        });

        // Add interactivity
        cy.on('tap', 'node', function(evt){
            const node = evt.target;
            console.log('Tapped node:', node.id());
        });

        // Remove auto-fit and center to allow proper scrolling
        cy.zoom(1);

        // Enable panning and zooming with mouse controls
        cy.userPanningEnabled(true);
        cy.userZoomingEnabled(true);
        cy.boxSelectionEnabled(false);

        // Add scroll wheel zoom
        cy.on('wheel', function(evt) {
            evt.preventDefault();
        });

    </script>
</body>
</html>
